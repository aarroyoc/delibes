Antes de pasar a otros temas vamos a mencionar como podemos manipular los DataFrame en <a href="http://pandas.pydata.org/">Pandas</a>. Imaginemos que tenemos una tabla con datos de estatura y peso. Podemos generar una nueva columna con el índice de masa corporal. Veamos como se puede hacer<br><h3>Fichero de ejemplo</h3><br><pre class="lang:default decode:true" title="pesos.csv">nombre,peso,altura<br>Basilio,67,1.5<br>Arturo,80,1.7<br>Cristina,50,1.4<br>Alfonso,100,2.0<br>Nerea,70,1.8</pre><br><h2>Seleccionado datos</h2><br>A veces queremos quedarnos con parte de los datos que cumplen una condición. Hay varias maneras de hacerlo.<br><br><em>Ejemplo: Quédate con los datos de Nombre y Altura de los pacientes con peso igual o superior a 70</em><br><pre class="lang:python decode:true">import pandas as pd<br><br>df = pd.read_csv("pesos.csv")<br><br>tab = df.loc[df["peso"] &gt;= 70,["nombre","altura"]]</pre><br><pre class="lang:python decode:true">import pandas as pd<br><br>df = pd.read_csv("pesos.csv")<br><br>tab = df[df["peso"] &gt;= 70][["nombre","altura"]]</pre><br><pre class="lang:python decode:true">import pandas as pd<br><br>df = pd.read_csv("pesos.csv")<br><br>tab = df.query("peso &gt;= 70")[["nombre","altura"]]</pre><br>Cualquiera de estos tres métodos pueden usarse indistintamente.<br><br><a href="https://files.adrianistan.eu/DataFrameQuery-1.png"><img class="aligncenter size-full wp-image-1106" src="https://files.adrianistan.eu/DataFrameQuery-1.png" alt="" width="341" height="73" /></a><br><h2>Apply</h2><br>Apply es una función de DataFrame muy potente que permite aplicar una función a todos las columnas o a todas las filas.<br><br><em>Ejemplo: Calcule el IMC (Índice de Masa Corporal) con los valores de la tabla</em><br><pre class="lang:python decode:true ">import pandas as pd<br><br>df = pd.read_csv("pesos.csv")<br><br>def imc(x):<br>    return x["peso"]/(x["altura"]**2)<br><br>df["imc"] = df.apply(imc,axis=1)<br>print(df)</pre><br><a href="https://files.adrianistan.eu/DataFrameApply.png"><img class="aligncenter size-full wp-image-1103" src="https://files.adrianistan.eu/DataFrameApply.png" alt="" width="637" height="293" /></a><br><h2>Drop</h2><br>¿Qué pasa si queremos borrar algún dato o columna?<br><br>Si queremos borrar columnas:<br><pre class="lang:default decode:true ">df.drop(["peso"],axis=1)</pre><br>Si queremos borrar datos:<br><pre class="lang:python decode:true">df.drop(ELEMENTOS,inplace=True)<br><br># puede haber una condicion compleja<br>df.drop(df[df["altura"] &lt; 1.6].index,axis=0,inplace=True)</pre><br><h2>Construyendo el DataFrame a mano</h2><br>Normalmente los datos los leeremos de algún archivo o base de datos (<strong>read_csv</strong>, <strong>read_json, read_html, read_sql, read_hdf, read_msgpack, read_excel, read_pickle, read_gbq, read_parquet, </strong>...) pero puede darse el caso de que necesitemos ingresar los datos manualmente. El constructor de <strong>DataFrame</strong> admite diccionarios, arrays de NumPy y arrays de tuplas.<br><pre class="lang:python decode:true">import pandas as pd<br>import numpy as np<br><br>datos_dict = {"peso": [50,60], "altura": [1.6,1.7]}<br>df = pd.DataFrame(data=datos_dict)<br><br>datos_numpy = np.array([[50,1.6],[70,1.7]])<br>df = pd.DataFrame(data=datos_numpy,columns=("peso","altura"))<br><br>datos_tuple = [(50,1.6),(70,1.7)]<br>df = pd.DataFrame(data=datos_tuple,columns=("peso","altura"))</pre><br>&nbsp;<br><h2>Concatenar DataFrames</h2><br>Si tenemos varios DataFrames de características similares (columnas iguales) podemos unirlos. Hay que tener cuidado con los índices. Si el tema de los índices te da igual, usa <strong>ignore_index</strong>.<br><pre class="lang:python decode:true">import pandas as pd<br><br>df = pd.read_csv("pesos.csv")<br><br>datos1 = [("Emilio",78,1.6),("Rosa",80,1.8)]<br>df1 = pd.DataFrame(data=datos1,columns=("nombre","peso","altura"))<br><br>datos2 = [("Agustín",75,1.6),("Ana",90,1.8)]<br>df2 = pd.DataFrame(data=datos2,columns=("nombre","peso","altura"))<br><br>df = pd.concat([df,df1,df2],ignore_index=True)<br></pre><br><a href="https://files.adrianistan.eu/DataFrameConcat.png"><img class="aligncenter size-full wp-image-1107" src="https://files.adrianistan.eu/DataFrameConcat.png" alt="" width="500" height="206" /></a><br><h2>Join DataFrames</h2><br>Si vienes del mundo SQL quizá te suene el tema de los JOIN. En Pandas existe un potente sistema de <strong>join</strong>, similar al usado en las bases de datos SQL más importantes y con excelente rendimiento. Pandas soporta joins de tipo LEFT, RIGHT, OUTER e INNER.<br><pre class="lang:python decode:true">import pandas as pd<br><br>df = pd.read_csv("pesos.csv")<br><br>otros_datos = [("Nerea",19),("Irena",21)]<br>tab_edad = pd.DataFrame(data=otros_datos,columns=("nombre","edad"))<br><br>tab_right = pd.merge(df,tab_edad,on="nombre",how="right")<br>tab_left = pd.merge(df,tab_edad,on="nombre",how="left")<br>tab_inner = pd.merge(df,tab_edad,on="nombre",how="inner")<br>tab_outer = pd.merge(df,tab_edad,on="nombre",how="outer")</pre><br><a href="https://files.adrianistan.eu/DataFrameJoin.png"><img class="aligncenter size-full wp-image-1108" src="https://files.adrianistan.eu/DataFrameJoin.png" alt="" width="443" height="325" /></a>Con esto ya sabemos lo básico para manejarnos con DataFrames de Pandas<br><br>&nbsp;