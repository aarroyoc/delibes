Uno de los campos más importantes de la inteligencia artificial es el del tratamiento del lenguaje natural. Ya en 1955, en el primer evento sobre Inteligencia Artificial, y promovido entre otros por John McCarthy (creador de Lisp) y Claude Shannon (padre de la teoría de la información y promotor del uso del álgebra de boole para la electrónica), estas cuestiones entraron en el <a href="http://www-formal.stanford.edu/jmc/history/dartmouth/dartmouth.html">listado de temas</a>.<br><br>En aquella época se era bastante optimista con las posibilidades de describir el lenguaje natural (inglés, español, ...) de forma precisa con un conjunto de reglas de forma similar a las matemáticas. Luego se comprobó que esto no era una tarea tan sencilla.<br><br>Hoy día, es un campo donde se avanza mucho todos los días, aprovechando las técnicas de machine learning combinadas con heurísticas propias de cada lenguaje.<br><br><strong>Natural Language Understanding</strong> nos permite saber qué quiere decir una frase que pronuncia o escribe un usuario. Existen diversos servicios que provee de esta funcionalidad: <a href="https://www.ibm.com/watson/services/natural-language-understanding/">IBM Watson</a>, <a href="https://www.luis.ai/">Microsoft LUIS</a> y también existe software libre, como <a href="https://snips-nlu.readthedocs.io/en/latest/index.html">Snips NLU</a>.<br><br><a href="https://files.adrianistan.eu/Snips.png"><img class="aligncenter size-large wp-image-1432" src="https://files.adrianistan.eu/Snips-1024x538.png" alt="" width="840" height="441" /></a>Snips NLU es una librería hecha en <a href="https://blog.adrianistan.eu/rust-101-tutorial-rust-espanol/">Rust</a> y con interfaz en Python que funciona analizando el texto con datos entrenados gracias a machine learning y da como resultado un <strong>intent</strong>, o significado de la frase y el valor de los <strong>slots</strong>, que son <em>variables</em> dentro de la frase.<br><blockquote>¿Qué tiempo hará mañana en Molina de Aragón?</blockquote><br>Y Snips NLU nos devuelve:<br><ul><br> 	<li>intent: obtenerTiempo</li><br> 	<li>slots:<br><ul><br> 	<li>cuando: mañana</li><br> 	<li>donde: Molina de Aragón</li><br></ul><br></li><br></ul><br>Pero para esto, antes hay que hacer un par de cosas.<br><h2>Instalar Snips NLU</h2><br>Instala Snips NLU con <a href="https://docs.pipenv.org/">Pipenv</a> (recomendado) o Pip:<br><pre class="lang:default decode:true">pipenv install snips-nlu</pre><br><pre class="lang:default decode:true">pip install snips-nlu</pre><br>&nbsp;<br><h2>Datos de entrenamiento</h2><br>En primer lugar vamos a crear un listado de frases que todas expresen la intención de obtener el tiempo y lo guardamos en un fichero llamado <strong>obtenerTiempo.txt</strong>. Así definimos un intent:<br><pre class="lang:default decode:true">¿Qué tiempo hará [cuando:snips/time](mañana) en [donde:localidad](Molina de Aragón)?<br>¿Qué tal hará [cuando:snips/time](pasado mañana) en [donde:localidad](Ponferrada)?<br>¿Qué temperatura habrá [cuando:snips/time](mañana) en [donde:localidad](Frías)?<br></pre><br>La sintaxis es muy sencilla. Cada frase en una línea. Cuando una palabra forme parte de un slot, se usa la sintaxis [NOMBRE SLOT:TIPO](texto). En el caso de [donde:localidad](Frías). Donde es el nombre del slot, localidad es el tipo de dato que va y Frías es el texto original de la frase. En el caso del slot cuando, hemos configurado el tipo como <em>snips/time</em> que es uno de los predefinidos por Snips NLU.<br><br>Creamos también un fichero llamado <strong>localidad.txt</strong>, con los posibles valores que puede tener localidad. Esto no quiere decir que no capture valores fuera de esta lista, como veremos después, pero tienen prioridad si hubiese más tipos. También se puede configurar a que no admita otros valores, pero no lo vamos a ver aquí.<br><pre class="lang:default decode:true">Burgos<br>Valladolid<br>Peñaranda de Bracamonte<br>Soria<br>Almazán<br>Íscar<br>Portillo<br>Toro<br>Fermoselle<br>Sahagún<br>Hervás<br>Oña<br>Saldaña<br>Sabiñánigo<br>Jaca<br></pre><br>Ahora generamos un fichero JSON listo para ser entrenado con el comando <strong>generate-dataset</strong>.<br><pre class="lang:default decode:true">generate-dataset --language es --intent-files obtenerTiempo.txt --entity-files localidad.txt &gt; dataset.json</pre><br><h2>Entrenamiento</h2><br>Ya estamos listos para el entrenamiento. Creamos un fichero Python como este y lo ejecutamos:<br><pre class="lang:python decode:true">import io<br>import json<br>from snips_nlu import load_resources, SnipsNLUEngine<br><br>load_resources("es")<br><br>with io.open("dataset.json") as f:<br>    dataset = json.load(f)<br><br>engine = SnipsNLUEngine()<br><br>engine.fit(dataset)<br><br>engine_json = json.dumps(engine.to_dict())<br>with io.open("trained.json",mode="w") as f:<br>    f.write(engine_json)</pre><br>El entrenamiento se produce en <strong>fit</strong>, y esta tarea puede tardar dependiendo del número de datos que metamos. Una vez finalizado, generama un fichero trained.json con el entrenamiento ya realizado.<br><h2>Hacer preguntas</h2><br>Ha llegado el momento de hacer preguntas, cargando el fichero de los datos entrenados.<br><pre class="lang:python decode:true">import io<br>import json<br>from snips_nlu import SnipsNLUEngine, load_resources<br><br>load_resources("es")<br><br>with io.open("trained.json") as f:<br>    engine_dict = json.load(f)<br><br>engine = SnipsNLUEngine.from_dict(engine_dict)<br><br>phrase = input("Pregunta: ")<br><br>r = engine.parse(phrase)<br>print(json.dumps(r, indent=2))</pre><br><a href="https://files.adrianistan.eu/PythonSNIPS.png"><img class="aligncenter size-full wp-image-1428" src="https://files.adrianistan.eu/PythonSNIPS.png" alt="" width="787" height="633" /></a>Ahora sería tarea del programador usar el valor del intent y de los slots para dar una respuesta inteligente.<br><br>Te animo a que te descargues el proyecto o lo hagas en casa e intentes hacerle preguntas con datos retorcidos a ver qué pasa y si guarda en los slots el valor correcto.