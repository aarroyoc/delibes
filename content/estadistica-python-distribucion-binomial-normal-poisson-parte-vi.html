Después del rollo del capítulo anterior, vamos a entrar en algo más práctico, modelos de probabilidad. Hemos hablado de las funciones de probabilidad y de densidad, sin embargo, nos falta algo muy importante. ¿Cuáles son esas funciones exactamente? Es donde entran los modelos de probabilidad, modelos estadísticos que se pueden ajustar a una variable aleatoria con mejor o peor precisión y que nos dan los valores de la probabilidad. Empecemos, pero antes hagamos un apunte sobre las equivalencias en SciPy:<br><ul><br> 	<li><strong>cdf(x)</strong> - Función de distribución F(X)</li><br> 	<li><strong>sf(x)</strong> = 1 - cdf(x)</li><br> 	<li><strong>pmf(x)</strong> - Función de probabilidad f(x) (distribuciones discretas)</li><br> 	<li><strong>pdf(x)</strong> - Función de densidad f(x) (distribuciones continuas)</li><br> 	<li><strong>ppf(x)</strong> - Función inversa a cdf(x). Nos permite obtener el valor correspondiente a una probabilidad.</li><br></ul><br><h2>Distribución Binomial</h2><br>Un ensayo de Bernouilli se define como un experimento donde puede darse un éxito o fracaso y donde cada ensayo es independiente del anterior. Por ejemplo, un ensayo de Bernoulli de parámetro 0.5 sería lanzar una moneda a cara o cruz (mitad de posibilidades de cara, mitad de posibilidades de cruz).<br><br>Si repetimos N veces los ensayos de Bernouilli tenemos una distribución binomial.<br><p style="text-align: center;">[latex]<br>X \rightarrow B(N,P)<br>[/latex]</p><br><br><div>SciPy nos permite usar <strong>binom</strong> para trabajar con distribuciones binomiales.</div><br><div></div><br><div><em>Ejemplo: Un proveedor de DVDs regrabables afirma que solamente el 4 % de los</em></div><br><div><em>artículos suministrados son defectuosos. Si un cliente compra un lote de 25</em></div><br><div><em>DVDs, ¿cuál es el número esperado de DVDs defectuosos en el lote? Si el cliente</em></div><br><div><em>encuentra que 4 de los DVDs comprados son defectuosos, ¿debe dudar de la</em></div><br><div><em>afirmación del vendedor?</em></div><br><div></div><br><div>El número de DVDs defectuosos esperados es el equivalente a decir el número medio de DVDs defectuosos.</div><br><div><br><pre class="lang:python decode:true ">import scipy.stats as ss<br><br>X = ss.binom(25,0.04)<br><br>X.mean() # 1.0</pre><br>Es decir, de media habría 1 DVD defectuoso en el paquete. <strong>mean</strong> calcula la media de la distribución.<br><br>Para saber si hay que fiarse del vendedor vamos a calcular cuál era la probabilidad de que nos tocasen 4 DVDs defectuosos.<br><pre class="lang:default decode:true">import scipy.stats as ss<br><br>X = ss.binom(25,0.04)<br><br>pr = X.sf(3) # 0.016521575032415914</pre><br>Es decir, la probabilidad que ocurriese era del 1%. Podemos sospechar del fabricante. <strong>cdf</strong> calcula las probabilidades acumuladas. En este caso tenemos que calcular la probabilidad de que hubiese 4 o más fallos, Pr{X&gt;=4}. Una manera fácil de calcularlo es hacer 1-Pr{X&lt;4}. <strong>cdf</strong><strong>(n)</strong> nos permite calcular probabilidades acumuladas hasta N. Otra opción sería simplemente obtener la probabilidad de 0 DVDs defectuosos, 1 DVD defectuoso, de 2 DVDs defectuosos, de 3 DVDs defectuosos, sumarlo y restarlo de 1.<br><pre class="lang:python decode:true">import scipy.stats as ss<br><br>X = ss.binom(25,0.04)<br><br>pr = 1 - sum(X.pmf(x) for x in range(4))</pre><br><strong>pmf(n)</strong> devuelve la probabilidad de que X=N, Pr{X=N} Esto solo tiene sentido en ciertas distribuciones, las discretas, como es el caso de la binomial.<br><br>Podemos calcular la gráfica de esta distribución binomial.<br><pre class="lang:python decode:true">import scipy.stats as ss<br>import matplotlib.pyplot as plt<br><br>X = ss.binom(25,0.04)<br>x = np.arange(10)<br><br>plt.plot(x,X.pmf(x),"bo")<br>plt.vlines(x,0,X.pmf(x),"b")<br>plt.show()</pre><br><a href="https://files.adrianistan.eu/Binomial.png"><img class="aligncenter size-full wp-image-1190" src="https://files.adrianistan.eu/Binomial.png" alt="" width="640" height="480" /></a>En el gráfico también se puede ver que las probabilidades de tener 4 o más DVDs defectuosos son mínimas.<br><br></div><br><h2>Distribución hipergeométrica</h2><br>La distribución hipergeométrica es un modelo en el que se considera una población finita de tamaño N en la cual hay M individuos con una determinada característica y se seleccionan n y queremos saber la probabilidad de que haya cierto número de individuos con esa característica en la selección. Para trabajar con estas distribuciones, SciPy trae <strong>hypergeom</strong>.<br><br><em>Ejemplo: Se formó un jurado de 6 personas de un grupo de 20 posibles miembros de los cuales 8 eran mujeres y 12 hombres. El jurado seelecionó aleatoriamente, pero solamente tenía 1 mujer. ¿Hay motivos para dudarde la aletoriedad de la selección?</em><br><pre class="lang:python decode:true ">import scipy.stats as ss<br><br>X = ss.hypergeom(20,6,8)<br><br>X.cdf(1) # 0.18730650154798736</pre><br>La probabilidad de que ocurriese lo que ocurrió es del 18,7%, una probabilidad suficientemente alta como para pensar que no hubo manipulación. Podemos dibujar esta hipergeométrica:<br><br><a href="https://files.adrianistan.eu/Hipergeometrica.png"><img class="aligncenter size-full wp-image-1191" src="https://files.adrianistan.eu/Hipergeometrica.png" alt="" width="640" height="480" /></a>Como se puede observar en la gráfica el caso más probable, con cerca del 35% de posibilidades era que hubiese dos mujeres seleccionadas. Destacar también, que la probabilidad de que haya 7 mujeres en el jurado es cero, porque solo hay 6 plazas en el jurado.<br><h2>Distribución de Poisson</h2><br>La distribución de Poisson recoge sucesos independientes que ocurren en un soporte continuo. El número medio de sucesos por unidad de soporte se le conoce como <strong>λ</strong> y caracteriza la distribución. <strong>poisson</strong> nos permite crear distribuciones de este tipo.<br><br>Algunos ejemplos de distribuciones de Poisson: número de clientes que llegan cada hora a cierto puesto de servicio, número de averías diarias de un sistema informático, número de vehículos que pasan diariamente por un túnel, número de defectos por kilómetro de cable, ...<br><br><em>Ejemplo: </em><em>La impresora de una pequeña red informática recibe una media de 0</em><em>.1 </em><em>peticiones por segundo. Suponiendo que las peticiones a dicha impresora son </em><em>independientes y a ritmo constante, ¿cuál es la probabilidad de un máximo de 2 </em><em>peticiones en un segundo? Si la cola de la impresora tiene un comportamiento </em><em>deficiente cuando recibe más de 10 peticiones en un minuto, ¿cuál es la </em><em>probabilidad de que ocurra esto?</em><br><pre class="lang:python decode:true  ">import scipy.stats as ss<br><br>X = ss.poisson(0.1)<br>X.cdf(2) # 0.99984534692973537<br><br>Y = ss.poisson(6)<br>Y.sf(10) # 0.042620923582537995</pre><br><a href="https://files.adrianistan.eu/Poisson.png"><img class="wp-image-1193 size-full" src="https://files.adrianistan.eu/Poisson.png" alt="" width="640" height="480" /></a> Variable Y: número de peticiones a la impresora en un minuto (y la probabilidad de que suceda)<br><h2>Distribución exponencial</h2><br>Para modelizar el intervalo entre dos sucesos consecutivos que siguen una distribución de Poisson se usa la distribución exponencial de parámetro <strong>λ</strong>.<br><br><em>Ejemplo: </em><em>El proceso de accesos a una página web se produce de una forma </em><em>estable e independiente, siendo el intervalo entre dos accesos consecutivos una </em><em>v.a. exponencial. Sabiendo que, de media, se produce un acceso cada minuto,</em><em>¿cuál es la probabilidad de que no se produzcan accesos en 4 minutos? y ¿cuál es</em><em>la probabilidad de que el tiempo transcurrido entre dos accesos consecutivos sea </em><em>inferior a 90 segundos?</em><br><br>Esta distribución en SciPy es un poco rara, ya que no está implementada como podría esperarse.<br><pre class="lang:python decode:true ">import scipy.stats as ss<br><br>ss.expon.sf(4,loc=0,scale=1) # 0.018315638888734179<br>ss.expon.cdf(1.5,loc=0,scale=1) # 0.77686983985157021</pre><br><h2>Distribución normal</h2><br>Probablemente el modelo de distribución más usado y conocido. Lo usamos para describir variables reales continuas.<br><br><em>Ejemplo: La duración de un determinado componente electrónico, en horas, es una v.a. que se distribuye según una N(2000,40). ¿Cuál es la probabilidad de que la duración de una de esas componentes sea superior a 1900 horas? ¿y de que esté entre 1850 y 1950 horas?</em><br><pre class="lang:python decode:true ">import scipy.stats as ss<br><br>X = ss.norm(2000,40)<br>X.sf(1900) # 0.99379033467422384<br>X.cdf(1950) - X.cdf(1850) # 0.10556135638165455<br></pre><br>Podemos representar esta variable.<br><pre class="lang:python decode:true">import scipy.stats as ss<br>import numpy as np<br>import matplotlib.pyplot as plt<br><br>X = ss.norm(2000,40)<br>x = np.arange(X.ppf(0.01),X.ppf(0.99))<br><br>plt.plot(x,X.pdf(x),"r")<br>plt.show()</pre><br><a href="https://files.adrianistan.eu/Normal.png"><img class="aligncenter size-full wp-image-1195" src="https://files.adrianistan.eu/Normal.png" alt="" width="640" height="480" /></a>Estos modelos no son perfectos, pero son lo suficientemente flexibles para ser un buen punto de partida.