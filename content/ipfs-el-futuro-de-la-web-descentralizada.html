Imagina la web sin servicios centralizados. Donde puedas acceder a un vídeo o a una galería de fotos y que no haya una única manera de acceder a contenido. Eso y mucho más es <strong>IPFS</strong>. <a href="https://ipfs.io/">IPFS</a> son las siglas de <strong>InterPlanetary File System</strong> y se trata de una red descentralizada de intercambio de archivos. Nos puede recordar a BitTorrent y en efecto, una buena descripción para IPFS es Torrent 2.0. No obstante IPFS implementa bastantes mejoras sobre BitTorrent, mejoras que lo hacen más útil.<br><br><a href="https://files.adrianistan.eu/IPFS.png"><img class="aligncenter size-full wp-image-1587" src="https://files.adrianistan.eu/IPFS.png" alt="" width="600" height="200" /></a><br><br>En un post próximo explicaré como podemos sacar partido a IPFS ahora mismo, pero antes vamos a ver algunos conceptos fundamentales de IPFS.<br><br>Siendo más técnicos, IPFS es una red P2P inspirada en BitTorrent, Git y Kademlia. El protocolo es una red de distribución de contenido (CDN) y define un sistema de archivos donde el identificador es el propio contenido (a través de su hash). En IPFS nada desaparece sino que se versiona.<br><br>Vamos a ver como usar IPFS desde la terminal. Existen varios clientes, en diferentes lenguajes, como js-ipfs (que tendrá mucha utilidad en aplicaciones web descentralizadas usando JavaScript), pero de momento el cliente más maduro es go-ipfs. <a href="https://dist.ipfs.io/#go-ipfs">Desde la web puedes descargarlo</a>.<br><h2>Iniciar IPFS</h2><br>Una vez IPFS esté instalado hay que ejecutar lo siguiente:<br><pre class="lang:default decode:true ">ipfs init<br>o<br>ipfs init --profile server</pre><br>La segunda opción es para centros de datos, ya que reduce el tráfico interno.<br><br><a href="https://files.adrianistan.eu/IPFS-Init.png"><img class="aligncenter size-full wp-image-1588" src="https://files.adrianistan.eu/IPFS-Init.png" alt="" width="735" height="164" /></a>Este comando genera las claves RSA del nodo, necesarias para la comunicación con la red IPFS. Además se nos informa de nuestro ID de nodo. Para acceder a este ID en cualquier momento podemos escribir:<br><pre class="lang:default decode:true">ipfs id</pre><br><h2>Iniciar el nodo IPFS</h2><br>Para acceder al contenido IPFS necesitamos ejecutar un nodo. Este nodo se inicia con <strong>ipfs daemon</strong>. Una cosa importante es que por ejecutar el nodo no se va a descargar nada que no pidamos. IPFS es explícito, pero necesita estar activo.<br><pre class="lang:default decode:true ">ipfs daemon</pre><br><h2><a href="https://files.adrianistan.eu/IPFS-Daemon.png"><img class="aligncenter size-full wp-image-1590" src="https://files.adrianistan.eu/IPFS-Daemon.png" alt="" width="829" height="288" /></a>Obtener archivos</h2><br>Ahora vamos a descargar nuestros primeros archivos de la red IPFS.<br><br>Para obtener un archivo existen varias formas:<br><pre class="lang:default decode:true">ipfs cat /ipfs/QmS4ustL54uo8FzR9455qaxZwuMiUhyvMcX9Ba8nUH4uVv/readme<br>o<br>ipfs cat QmS4ustL54uo8FzR9455qaxZwuMiUhyvMcX9Ba8nUH4uVv/readme</pre><br>Podemos usar el comando <strong>cat</strong> de IPFS, que funciona de forma similar a cat de Unix.<br><br>Las URL de IPFS todavía no han sido definidas de forma definitiva pero de momento siguen el siguiente formato: <em>/protocolo (omitible)/hash/fichero (si es una carpeta)</em>. Es el hash el que identifica el <em>bloque de contenido</em> y es lo que sirve para encontrar el contenido en la red IPFS. Internamente usa una DHT (<em>Distributed Hash Table).</em> IPFS no usa trackers como las primeras versiones de BitTorrent. En cambio usa una DHT basada en Kademlia (bastante rápida).<br><br>Para obtener un fichero binario usamos el operador de redirección de Linux.<br><pre class="lang:default decode:true">ipfs cat QmWYhH2Nac5vSgTmc6NULncakvhCXgAci33M5NXHjjBuU8 &gt; Comuneros.jpg</pre><br>También se puede acceder a IPFS por dos métodos más:<br><h5>FUSE</h5><br>Podemos montar un sistema de ficheros en Linux gracias a FUSE que es una puerta a IPFS.<br><pre class="lang:default decode:true ">ipfs mount</pre><br>Y tendrás acceso a carpetas <em>/ipfs/hash/</em> integradas en tu sistema. Muy útil si lo queremos integrar en aplicaciones.<br><h5>GATEWAY HTTP</h5><br>Podemos usar IPFS sin tener instalado nada, usando la <em>puerta de acceso</em> que alguien generosamente proporcione a la red. La puerta se encargará de llevar el contenido IPFS al mundo cliente-servidor de HTTP. Existen varias, de hecho cada nodo tiene un servidor HTTP en localhost para esto mismamente, pero aquí voy a mencionar dos: la de IPFS.io y la de CloudFare.<br><ul><br> 	<li>IPFS.io: <a href="https://ipfs.io/ipfs/QmWYhH2Nac5vSgTmc6NULncakvhCXgAci33M5NXHjjBuU8">https://ipfs.io/ipfs/QmWYhH2Nac5vSgTmc6NULncakvhCXgAci33M5NXHjjBuU8</a> (se prepone https://ipfs.io a la URL de IPFS).</li><br> 	<li>CloudFare: <a href="https://cloudflare-ipfs.com/ipfs/QmWYhH2Nac5vSgTmc6NULncakvhCXgAci33M5NXHjjBuU8">https://cloudflare-ipfs.com/ipfs/QmWYhH2Nac5vSgTmc6NULncakvhCXgAci33M5NXHjjBuU8</a> (se prepone https://cloudfare-ipfs.com a la URL de IPFS).</li><br></ul><br>Esto sirve para llevar IPFS a cualquier ordenador a través de un navegador web tradicional como Chrome, Firefox o Safari. También facilita la tarea de integrar IPFS en aplicaciones que no tengan desarrollada una librería específica.<br><h2>Añadir archivos</h2><br>Ahora vamos a poner en la red IPFS nuevos archivos. Para ello usamos <strong>ipfs add</strong>.<br><br><a href="https://files.adrianistan.eu/IPFS-Add.png"><img class="aligncenter size-large wp-image-1589" src="https://files.adrianistan.eu/IPFS-Add-1024x56.png" alt="" width="840" height="46" /></a>Esta operación genera el hash que identifica al contenido en la red y que tendremos que enviar a las personas que queramos que accedan al contenido.<br><br>La red IPFS de este modo es semi-privada, ya que sin saber el hash no podemos acceder al contenido en cuestión.<br><br>Y ya estaría, así de simple. También podemos añadir carpetas.<br><br><a href="https://files.adrianistan.eu/IPFS-AddFolder.png"><img class="aligncenter size-large wp-image-1593" src="https://files.adrianistan.eu/IPFS-AddFolder-1024x401.png" alt="" width="840" height="329" /></a>El último hash que se ve en la pantalla hace referencia a la carpeta entera.<br><h2>Pining</h2><br>Por defecto, IPFS almacena los archivos propios del nodo (los que hemos añadido con ipfs add). Pero entonces IPFS no supone ninguna ventaja respecto a HTTP. No es distribuido, solo hay una copia de los ficheros en el universo.<br><br>Cuando descargamos un fichero, IPFS guarda en caché una copia para ofrecer a la red, haciendo que sea un sistema distribuido de verdad. No obstante si estamos realmente interesados en conservar el fichero en nuestro nodo a disposición de la red IPFS tenemos que hacer pin <strong>(ipfs add).</strong> Cuando nos deje de interesar conservar el fichero a la red, podemos quitar el pin <strong>(ipfs rm</strong>).<br><pre class="lang:default decode:true ">ipfs pin add QmWYhH2Nac5vSgTmc6NULncakvhCXgAci33M5NXHjjBuU8<br>ipfs pin rm -r QmWYhH2Nac5vSgTmc6NULncakvhCXgAci33M5NXHjjBuU8</pre><br><h2>Más cosas</h2><br>Todavía nos quedan muchas cosas de IPFS que ver, como el versionado, el sistema de nombres IPNS, el sistema de enlazado semántico IPLD y como podemos usar IPFS para páginas y aplicaciones web.<br><br>&nbsp;